<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>Files &#8212; Python for Everybody - Interactive</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/accessibility.css?v=DB047029" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/handsontable@7.2.2/dist/handsontable.full.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/CodeChat.css" />
    <link rel="stylesheet" type="text/css" href="../_static/matrixeq.css?v=58BC228F" />
    <link rel="stylesheet" type="text/css" href="../_static/webgldemo.css?v=B36B48D" />
    <link rel="stylesheet" type="text/css" href="../_static/webglinteractive.css?v=910DF1E1" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-3.4.1/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/presenter_mode.css?v=9FF1320F" />
    <link rel="stylesheet" type="text/css" href="../_static/jquery-ui-1.10.3.custom.min.css?v=97E0178A" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/user-highlights.css?v=A2326E52" />
    <link rel="stylesheet" type="text/css" href="../_static/runestone-custom-sphinx-bootstrap.css?v=5.0.8" />
    <link rel="stylesheet" type="text/css" href="../_static/theme-overrides.css?v=2DAFE138" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/jquery.highlight.js?v=F1C496C8"></script>
    <script src="../_static/sql-wasm.js?v=44FE0709"></script>
    <script src="https://cdn.jsdelivr.net/npm/handsontable@7.2.2/dist/handsontable.full.js"></script>
    <script src="../_static/animationbase.js?v=A043C3A7"></script>
    <script src="../_static/pytutor-embed.bundle.js?v=268B5C04"></script>
    <script src="../_static/html4css1.css?v=4D8F3FB4"></script>
    <script src="../_static/matrixeq.js?v=D64CFA5A"></script>
    <script src="../_static/webglinteractive.js?v=2B768384"></script>
    <script src="../_static/FileSaver.min.js?v=8408C997"></script>
    <script src="../_static/Blob.js?v=AEC2447"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.i18n/1.0.5/jquery.i18n.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.i18n/1.0.5/jquery.i18n.emitter.bidi.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.i18n/1.0.5/jquery.i18n.emitter.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.i18n/1.0.5/jquery.i18n.fallbacks.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.i18n/1.0.5/jquery.i18n.messagestore.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.i18n/1.0.5/jquery.i18n.parser.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.i18n/1.0.5/jquery.i18n.language.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega@4.0.0-rc.2/build/vega.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@2.5.0/build/vega-lite.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@3.14.0/build/vega-embed.js"></script>
    <script src="../_static/runestone.js?v=3EAD674C"></script>
    <script src="../_static/jquery-ui-1.10.3.custom.min.js?v=2B07FE4F"></script>
    <script src="../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
    <script src="../_static/jquery-fix.js?v=1226591B"></script>
    <script src="../_static/bootstrap-sphinx.js"></script>
    <script src="../_static/jquery.idle-timer.js?v=E942DAF1"></script>
    <script src="../_static/presenter_mode.js?v=2DF16FB4"></script>
    <script src="../_static/theme.js?v=D899FB97"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
<link rel="shortcut icon" href="/runestone/static/favicon.ico" type="image/ico" />

<script type="text/javascript">
  eBookConfig = {};
  
    eBookConfig.useRunestoneServices = true;
    eBookConfig.host = 'http://127.0.0.1:8000' || 'http://127.0.0.1:8000';
    eBookConfig.app = eBookConfig.host+'/runestone';
    eBookConfig.course = 'py4e-int';
    eBookConfig.basecourse = 'py4e-int';
    eBookConfig.isLoggedIn = false;
  
  eBookConfig.ajaxURL = eBookConfig.app+'/ajax/';
  eBookConfig.logLevel = 10;
  eBookConfig.loginRequired = false;
  eBookConfig.build_info = "unknown";
  eBookConfig.python3 = true;
  eBookConfig.acDefaultLanguage = '' ? '' : 'python'
  eBookConfig.runestone_version = '';
  eBookConfig.jobehost = '';
  eBookConfig.proxyuri_runs = '';
  eBookConfig.proxyuri_files = '';
  eBookConfig.enable_chatcodes = false ? false : false;


</script>

<!-- Ad Serving Headers Only serve ads to Anonymous Users -->



<div id="fb-root"></div>
<script>
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&status=0";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>



  </head><body>


<!-- Begin navbar -->
<div id="navbar" class="navbar navbar-default navbar-fixed-top" role="navigation">

  <div class="container">

    <div class="navbar-header">
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <button type='button' class='navbar-toggle' data-toggle="collapse" data-target=".navbar-ex1-collapse">
        <span class="icon-bar" aria-label="navbar toggle" class="visuallyhidden">toggle navbar</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div>
        
          <a class="brand-logo" style='background: transparent url("../_static/img/logo_small.png") no-repeat 0px 0px;' href="/runestone/default/user/login">&nbsp; </a>
        
        <a class="navbar-brand" href="../index.html" aria-label="index-page">
          
          py4e-int
        </a>
      </div>
    </div>



    <div class="navbar-collapse collapse navbar-ex1-collapse">
      <ul class="nav navbar-nav navbar-right" >

        <li class="divider-vertical"></li>


        <!-- social media dropdown -->
        
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-globe" style="opacity: 0.9"><span aria-label="Social" class="visuallyhidden">Social</span></i>
          </a>
          <ul class="dropdown-menu social-menu">
              <li>
                <div>
                  <b>Runestone in social media:</b>
                </div>
                <a href="https://twitter.com/iRunestone" class="twitter-follow-button" data-show-count="true">Follow @iRunestone</a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
                <div class="fb-like" data-href="https://www.facebook.com/RunestoneInteractive" data-send="false" data-layout="button_count" data-width="300" data-show-faces="false" data-font="arial"></div>
              </li>

              <li class="divider"></li>
              <li>
                <div>
                  <b>Help support us:</b>
                </div>
                <div>
                    <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
                  <input type="hidden" name="cmd" value="_s-xclick">
                  <input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----MIIHNwYJKoZIhvcNAQcEoIIHKDCCByQCAQExggEwMIIBLAIBADCBlDCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb20CAQAwDQYJKoZIhvcNAQEBBQAEgYAcrkqh1hn3lYqIpfXxNqe1T82EhXzCJGy1yMAmklpyZshyMkfDGe1Bhx+iwyGeoYRTTyphFmP+9M3NyO0+Q5XdHxgZPx/zYjjBxlZHgEV6jhE8bN2fHkkPf0VHfz0a0QQylQOPlKiOTZV7B37Jpk6yM47oVZ1tG/KNm0NkfmB76DELMAkGBSsOAwIaBQAwgbQGCSqGSIb3DQEHATAUBggqhkiG9w0DBwQIi0GmFfOlcjuAgZBbYOo9UO+CpMQa+PYqwsUmUnJvXIImeMeNI3KVTUx5Cfk9gNMo3WzPeiB5IqZo9nRAQ0mf1qL2ecLeB5tidM+lgBUhOxfj3/FecpnVFa0263gp4g+PLw8jzhvVRdUon1K3SeO1Rzh23fIRKwnrD6btt73uwtj0sl3tGd8qz+6GIcwPDdRk9VcUffiBJT/ZagKgggOHMIIDgzCCAuygAwIBAgIBADANBgkqhkiG9w0BAQUFADCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb20wHhcNMDQwMjEzMTAxMzE1WhcNMzUwMjEzMTAxMzE1WjCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb20wgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAMFHTt38RMxLXJyO2SmS+Ndl72T7oKJ4u4uw+6awntALWh03PewmIJuzbALScsTS4sZoS1fKciBGoh11gIfHzylvkdNe/hJl66/RGqrj5rFb08sAABNTzDTiqqNpJeBsYs/c2aiGozptX2RlnBktH+SUNpAajW724Nv2Wvhif6sFAgMBAAGjge4wgeswHQYDVR0OBBYEFJaffLvGbxe9WT9S1wob7BDWZJRrMIG7BgNVHSMEgbMwgbCAFJaffLvGbxe9WT9S1wob7BDWZJRroYGUpIGRMIGOMQswCQYDVQQGEwJVUzELMAkGA1UECBMCQ0ExFjAUBgNVBAcTDU1vdW50YWluIFZpZXcxFDASBgNVBAoTC1BheVBhbCBJbmMuMRMwEQYDVQQLFApsaXZlX2NlcnRzMREwDwYDVQQDFAhsaXZlX2FwaTEcMBoGCSqGSIb3DQEJARYNcmVAcGF5cGFsLmNvbYIBADAMBgNVHRMEBTADAQH/MA0GCSqGSIb3DQEBBQUAA4GBAIFfOlaagFrl71+jq6OKidbWFSE+Q4FqROvdgIONth+8kSK//Y/4ihuE4Ymvzn5ceE3S/iBSQQMjyvb+s2TWbQYDwcp129OPIbD9epdr4tJOUNiSojw7BHwYRiPh58S1xGlFgHFXwrEBb3dgNbMUa+u4qectsMAXpVHnD9wIyfmHMYIBmjCCAZYCAQEwgZQwgY4xCzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNTW91bnRhaW4gVmlldzEUMBIGA1UEChMLUGF5UGFsIEluYy4xEzARBgNVBAsUCmxpdmVfY2VydHMxETAPBgNVBAMUCGxpdmVfYXBpMRwwGgYJKoZIhvcNAQkBFg1yZUBwYXlwYWwuY29tAgEAMAkGBSsOAwIaBQCgXTAYBgkqhkiG9w0BCQMxCwYJKoZIhvcNAQcBMBwGCSqGSIb3DQEJBTEPFw0xMzExMDMxMzQxMzFaMCMGCSqGSIb3DQEJBDEWBBRDJF8w+zsMr7FSk+pwinB5f5D4rzANBgkqhkiG9w0BAQEFAASBgHw1LMHpkpaqHIvDGdFE0eG+2mZlmMnUeDCBhQlbc7QMzFQYKTV94NfaebBO4PmNdADe1rq4WidSRZZbE7CzkX9IGENYnBTWY0hb2l0lGdGrJdGeWyV3ekg9WVaFMMumrekds96h3Cx7dGz2kWDzIai2iEXE/qoE+xpkyXAYZNV3-----END PKCS7-----
                  ">
                  <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_SM.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
                  <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
                  </form>

                </div>
              </li>
          </ul>
        </li><!-- end social media dropdown -->

        <li class="divider-vertical"></li>

        <!-- search dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-search" style='opacity:0.9;'><span aria-label="Search" class="visuallyhidden">Search</span></i>
          </a>
          <ul class='dropdown-menu'>
            
                <li><a href='../index.html' aria-label="index-page">Table of Contents</a></li>
            
            <li><a href='../genindex.html'>Book Index</a></li>
            <li class="divider"></li>
            <li style="width: 240px;">
              <form class="navbar-search" style="margin:10px;" action="../search.html" method="get">
                <div class="input-group">
                  <input type="text" class="form-control" name="q" placeholder="Search this book" />
                  <span class="input-group-btn">
                    <button class="btn btn-primary" style="margin:0;" type="submit">
                      <i class="glyphicon glyphicon-search"></i>
                    </button>
                  </span>
                </div><!-- /input-group -->
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
            </li>
          </ul>
        </li>
        <!-- end search dropdown -->

        <li class="divider-vertical"></li>

        
        <!-- user account dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-user" style="opacity:0.9;"><span aria-label="User" class="visuallyhidden">User</span></i>
          </a>
          <ul class="dropdown-menu user-menu">
            <li><span class='loggedinuser'></span></li>
            <li class="divider"></li>
            <li><a href='/runestone/assignments/chooseAssignment.html'>Assignments</a></li>
            <li><a href='/runestone/assignments/practice'>Practice</a></li>
            <li class="divider"></li>
            
            <li><a href='/runestone/default/courses'>Change Course</a></li>
			      <li class="divider"></li>
            <li id="ip_dropdown_link"><a href='/runestone/admin/index'>Instructor's Page</a></li>
            
            <li><a href='/runestone/dashboard/studentreport'>Progress Page</a></li>
            <li class="divider"></li>
            
            <li><a href="/runestone/default/user/profile" id="profilelink">Edit Profile</a></li>
            <li><a href="/runestone/default/user/change_password" id="passwordlink">Change Password</a></li>
            <li><a href="/runestone/default/user/register" id="registerlink">Register</a></li>
            
            <li class='loginout'><a href='#'>Login</a></li> <!-- correct link populated by addNavbarLoginLink() -->
			<!-- dark mode toggle -->
             <li><label class="theme-switch" for="checkbox">
					  <input type="checkbox" id="checkbox" onchange="switchTheme()" />
							<div class="slider round"></div>
					</label>Dark Mode</li>
			 </ul>
        </li>
        <!-- end user account dropdown -->
        
        <li class="divider-vertical"></li>
        <!-- <li id="scratch_ac_link"><a href="javascript:ACFactory.toggleScratchActivecode()">Scratch ActiveCode</a></li> -->

        <!-- <li class="dropdown">             -->
          <li id="scratch_ac_link" class="dropdown"><a href="javascript:ACFactory.toggleScratchActivecode()">
              <i class="glyphicon glyphicon-pencil" style="opacity:0.9;"><span aria-label="Scratch Activecode" class="visuallyhidden">Scratch Activecode</span></i></a></li>
        <!-- </li> -->

        <li class="divider-vertical"></li>

        
        <!-- help menu dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-question-sign" style="opacity:0.9;"><span aria-label="Help" class="visuallyhidden">Help</span></i>
          </a>
          <ul class="dropdown-menu user-menu">
            <li><a href='http://runestoneinteractive.org/pages/faq.html'>FAQ</a></li>
            <li><a href='https://runestone.academy/runestone/static/instructorguide/index.html'>Instructors Guide</a></li>
            <li class="divider"></li>
            <li><a href='http://runestoneinteractive.org'>About Runestone</a></li>
            <li><a href='/runestone/default/reportabug?course=py4e-int&page=07-files'>Report A Problem</a></li>
          </ul>
        </li>
        <!-- end help menu dropdown -->

        <li class="divider-vertical"></li>
      
      </ul>

      <ul class="nav navbar-nav">
        <li class="divider-vertical"></li>
        
          
          <li class="divider-vertical"></li>
        
        <!-- 
          

<script type="text/javascript">
  opts = {'placement':'bottom',
          'selector': '',
          'delay': { show: 100, hide: 50}
         };

  $('#relations-prev').tooltip(opts);
  $('#relations-next').tooltip(opts);
</script>
        -->
        
          <li></li>
        
      </ul>

      </div> <!-- navbar -->







    </div> <!-- container -->
  </div>
</div>


<div class="container" id="continue-reading"></div>

<div class="container" id="main-content" role="main">
  
  <div class="section" id="files">
<h1>Files<a class="headerlink" href="#files" title="Permalink to this headline">¶</a></h1>
<p>index{file}
index{type!file}</p>
<div class="section" id="persistence">
<h2>Persistence<a class="headerlink" href="#persistence" title="Permalink to this headline">¶</a></h2>
<p>index{persistence}
index{secondary memory}</p>
<p>So far, we have learned how to write programs and communicate our
intentions to the <em>Central Processing Unit</em> using
conditional execution, functions, and iterations. We have learned how to
create and use data structures in the <em>Main Memory</em>. The
CPU and memory are where our software works and runs. It is where all of
the “thinking” happens.</p>
<p>But if you recall from our hardware architecture discussions, once the
power is turned off, anything stored in either the CPU or main memory is
erased. So up to now, our programs have just been transient fun
exercises to learn Python.</p>
<a class="reference external image-reference" href="height=2.5in&#64;../images/arch"><img alt="Secondary Memory" src="07-files\height=2.5in&#64;../images/arch" /></a>
<p>In this chapter, we start to work with <em>Secondary Memory</em>
(or files). Secondary memory is not erased when the power is turned
off. Or in the case of a USB flash drive, the data we write from our
programs can be removed from the system and transported to another
system.</p>
<p>We will primarily focus on reading and writing text files such as those
we create in a text editor. Later we will see how to work with database
files which are binary files, specifically designed to be read and
written through database software.</p>
</div>
<div class="section" id="opening-files">
<h2>Opening files<a class="headerlink" href="#opening-files" title="Permalink to this headline">¶</a></h2>
<p>index{file!open}
index{open function}
index{function!open}</p>
<p>When we want to read or write a file (say on your hard drive), we first
must <em>open</em> the file. Opening the file communicates with
your operating system, which knows where the data for each file is
stored. When you open a file, you are asking the operating system to
find the file by name and make sure the file exists. In this example, we
open the file <em>mbox.txt</em>, which should be stored in the same
folder that you are in when you start Python. You can download this file
from <a class="reference external" href="http://www.py4e.com/code3/mbox.txt">www.py4e.com/code3/mbox.txt</a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fhand</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;mbox.txt&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">fhand</span><span class="p">)</span>
<span class="go">&lt;_io.TextIOWrapper name=&#39;mbox.txt&#39; mode=&#39;r&#39; encoding=&#39;cp1252&#39;&gt;</span>
</pre></div>
</div>
<p>index{file handle}</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">open</span></code> is successful, the operating system returns us
a <em>file handle</em>. The file handle is not the actual data
contained in the file, but instead it is a “handle” that we can use to
read the data. You are given a handle if the requested file exists and
you have the proper permissions to read the file.</p>
<a class="reference external image-reference" href="height=2.0in&#64;../images/handle"><img alt="A File Handle" src="07-files\height=2.0in&#64;../images/handle" /></a>
<p>If the file does not exist, <code class="docutils literal notranslate"><span class="pre">open</span></code> will fail with a traceback
and you will not get a handle to access the contents of the file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; fhand = open(&#39;stuff.txt&#39;)
Traceback (most recent call last):
File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
FileNotFoundError: [Errno 2] No such file or directory: &#39;stuff.txt&#39;
</pre></div>
</div>
<p>Later we will use <code class="docutils literal notranslate"><span class="pre">try</span></code> and <code class="docutils literal notranslate"><span class="pre">except</span></code> to deal more
gracefully with the situation where we attempt to open a file that does
not exist.</p>
</div>
<div class="section" id="text-files-and-lines">
<h2>Text files and lines<a class="headerlink" href="#text-files-and-lines" title="Permalink to this headline">¶</a></h2>
<p>A text file can be thought of as a sequence of lines, much like a Python
string can be thought of as a sequence of characters. For example, this
is a sample of a text file which records mail activity from various
individuals in an open source project development team:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>From stephen.marquard@uct.ac.za Sat Jan  5 09:14:16 2008
Return-Path: &lt;postmaster@collab.sakaiproject.org&gt;
Date: Sat, 5 Jan 2008 09:12:18 -0500
To: source@collab.sakaiproject.org
From: stephen.marquard@uct.ac.za
Subject: [sakai] svn commit: r39772 - content/branches/
Details: http://source.sakaiproject.org/viewsvn/?view=rev&amp;rev=39772
...
</pre></div>
</div>
<p>The entire file of mail interactions is available from</p>
<p><a class="reference external" href="http://www.py4e.com/code3/mbox.txt">www.py4e.com/code3/mbox.txt</a></p>
<p>and a shortened version of the file is available from</p>
<p><a class="reference external" href="http://www.py4e.com/code3/mbox-short.txt">www.py4e.com/code3/mbox-short.txt</a></p>
<p>These files are in a standard format for a file containing multiple mail
messages. The lines which start with “From ” separate the messages and
the lines which start with “From:” are part of the messages. For more
information about the mbox format, see
<a class="reference external" href="https://en.wikipedia.org/wiki/Mbox">https://en.wikipedia.org/wiki/Mbox</a>.</p>
<p>To break the file into lines, there is a special character that
represents the “end of the line” called the <em>newline</em>
character.</p>
<p>index{newline}</p>
<p>In Python, we represent the <em>newline</em> character as a
backslash-n in string constants. Even though this looks like two
characters, it is actually a single character. When we look at the
variable by entering “stuff” in the interpreter, it shows us the <code class="docutils literal notranslate"><span class="pre">\n</span></code> in
the string, but when we use <code class="docutils literal notranslate"><span class="pre">print</span></code> to show the string, we
see the string broken into two lines by the newline character.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stuff</span> <span class="o">=</span> <span class="s1">&#39;Hello</span><span class="se">\n</span><span class="s1">World!&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stuff</span>
<span class="go">&#39;Hello\nWorld!&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">stuff</span><span class="p">)</span>
<span class="go">Hello</span>
<span class="go">World!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stuff</span> <span class="o">=</span> <span class="s1">&#39;X</span><span class="se">\n</span><span class="s1">Y&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">stuff</span><span class="p">)</span>
<span class="go">X</span>
<span class="go">Y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">stuff</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>You can also see that the length of the string <code class="docutils literal notranslate"><span class="pre">X\nY</span></code> is <em>three</em>
characters because the newline character is a single character.</p>
<p>So when we look at the lines in a file, we need to <em>imagine</em> that there
is a special invisible character called the newline at the end of each
line that marks the end of the line.</p>
<p>So the newline character separates the characters in the file into
lines.</p>
</div>
<div class="section" id="reading-files">
<h2>Reading files<a class="headerlink" href="#reading-files" title="Permalink to this headline">¶</a></h2>
<p>index{file!reading}
index{counter}</p>
<p>While the <em>file handle</em> does not contain the data for the
file, it is quite easy to construct a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop to read
through and count each of the lines in a file:</p>
<p>VerbatimInput{../code3/open.py}
begin{trinketfiles}
../code3/mbox-short.txt
end{trinketfiles}</p>
<p>We can use the file handle as the sequence in our <code class="docutils literal notranslate"><span class="pre">for</span></code> loop.
Our <code class="docutils literal notranslate"><span class="pre">for</span></code> loop simply counts the number of lines in the file
and prints them out. The rough translation of the <code class="docutils literal notranslate"><span class="pre">for</span></code> loop
into English is, “for each line in the file represented by the file
handle, add one to the <code class="docutils literal notranslate"><span class="pre">count</span></code> variable.”</p>
<p>The reason that the <code class="docutils literal notranslate"><span class="pre">open</span></code> function does not read the entire
file is that the file might be quite large with many gigabytes of data.
The <code class="docutils literal notranslate"><span class="pre">open</span></code> statement takes the same amount of time regardless
of the size of the file. The <code class="docutils literal notranslate"><span class="pre">for</span></code> loop actually causes the
data to be read from the file.</p>
<p>When the file is read using a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop in this manner,
Python takes care of splitting the data in the file into separate lines
using the newline character. Python reads each line through the newline
and includes the newline as the last character in the <code class="docutils literal notranslate"><span class="pre">line</span></code>
variable for each iteration of the <code class="docutils literal notranslate"><span class="pre">for</span></code> loop.</p>
<p>Because the <code class="docutils literal notranslate"><span class="pre">for</span></code> loop reads the data one line at a time, it
can efficiently read and count the lines in very large files without
running out of main memory to store the data. The above program can
count the lines in any size file using very little memory since each
line is read, counted, and then discarded.</p>
<p>If you know the file is relatively small compared to the size of your
main memory, you can read the whole file into one string using the
<code class="docutils literal notranslate"><span class="pre">read</span></code> method on the file handle.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fhand</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;mbox-short.txt&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inp</span> <span class="o">=</span> <span class="n">fhand</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">inp</span><span class="p">))</span>
<span class="go">94626</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">inp</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
<span class="go">From stephen.marquar</span>
</pre></div>
</div>
<p>In this example, the entire contents (all 94,626 characters) of the file
<em>mbox-short.txt</em> are read directly into the variable
<code class="docutils literal notranslate"><span class="pre">inp</span></code>. We use string slicing to print out the first 20
characters of the string data stored in <code class="docutils literal notranslate"><span class="pre">inp</span></code>.</p>
<p>When the file is read in this manner, all the characters including all
of the lines and newline characters are one big string in the variable
<code class="docutils literal notranslate"><span class="pre">inp</span></code>. It is a good idea to store the output of <code class="docutils literal notranslate"><span class="pre">read</span></code> as a variable
because each call to <code class="docutils literal notranslate"><span class="pre">read</span></code> exhausts the resource:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fhand</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;mbox-short.txt&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fhand</span><span class="o">.</span><span class="n">read</span><span class="p">()))</span>
<span class="go">94626</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fhand</span><span class="o">.</span><span class="n">read</span><span class="p">()))</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Remember that this form of the <code class="docutils literal notranslate"><span class="pre">open</span></code> function should only be used
if the file data will fit comfortably in the main memory of your computer.
If the file is too large to fit in main memory, you should write your
program to read the file in chunks using a <code class="docutils literal notranslate"><span class="pre">for</span></code> or <code class="docutils literal notranslate"><span class="pre">while</span></code> loop.</p>
</div>
<div class="section" id="searching-through-a-file">
<h2>Searching through a file<a class="headerlink" href="#searching-through-a-file" title="Permalink to this headline">¶</a></h2>
<p>When you are searching through data in a file, it is a very common
pattern to read through a file, ignoring most of the lines and only
processing lines which meet a particular condition. We can combine the
pattern for reading a file with string methods to build simple search
mechanisms.</p>
<p>index{filter pattern}
index{pattern!filter}</p>
<p>For example, if we wanted to read a file and only print out lines which
started with the prefix “From:”, we could use the string method
<em>startswith</em> to select only those lines with the desired
prefix:</p>
<p>VerbatimInput{../code3/search1.py}
begin{trinketfiles}
../code3/mbox-short.txt
end{trinketfiles}</p>
<p>When this program runs, we get the following output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">From</span><span class="p">:</span> <span class="n">stephen</span><span class="o">.</span><span class="n">marquard</span><span class="nd">@uct</span><span class="o">.</span><span class="n">ac</span><span class="o">.</span><span class="n">za</span>

<span class="n">From</span><span class="p">:</span> <span class="n">louis</span><span class="nd">@media</span><span class="o">.</span><span class="n">berkeley</span><span class="o">.</span><span class="n">edu</span>

<span class="n">From</span><span class="p">:</span> <span class="n">zqian</span><span class="nd">@umich</span><span class="o">.</span><span class="n">edu</span>

<span class="n">From</span><span class="p">:</span> <span class="n">rjlowe</span><span class="nd">@iupui</span><span class="o">.</span><span class="n">edu</span>
<span class="o">...</span>
</pre></div>
</div>
<p>The output looks great since the only lines we are seeing are those
which start with “From:”, but why are we seeing the extra blank lines?
This is due to that invisible <em>newline</em> character. Each
of the lines ends with a newline, so the <code class="docutils literal notranslate"><span class="pre">print</span></code> statement
prints the string in the variable <em>line</em> which includes a
newline and then <code class="docutils literal notranslate"><span class="pre">print</span></code> adds <em>another</em> newline, resulting in
the double spacing effect we see.</p>
<p>We could use line slicing to print all but the last character, but a
simpler approach is to use the <em>rstrip</em> method which
strips whitespace from the right side of a string as follows:</p>
<p>VerbatimInput{../code3/search2.py}
begin{trinketfiles}
../code3/mbox-short.txt
end{trinketfiles}</p>
<p>When this program runs, we get the following output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">From</span><span class="p">:</span> <span class="n">stephen</span><span class="o">.</span><span class="n">marquard</span><span class="nd">@uct</span><span class="o">.</span><span class="n">ac</span><span class="o">.</span><span class="n">za</span>
<span class="n">From</span><span class="p">:</span> <span class="n">louis</span><span class="nd">@media</span><span class="o">.</span><span class="n">berkeley</span><span class="o">.</span><span class="n">edu</span>
<span class="n">From</span><span class="p">:</span> <span class="n">zqian</span><span class="nd">@umich</span><span class="o">.</span><span class="n">edu</span>
<span class="n">From</span><span class="p">:</span> <span class="n">rjlowe</span><span class="nd">@iupui</span><span class="o">.</span><span class="n">edu</span>
<span class="n">From</span><span class="p">:</span> <span class="n">zqian</span><span class="nd">@umich</span><span class="o">.</span><span class="n">edu</span>
<span class="n">From</span><span class="p">:</span> <span class="n">rjlowe</span><span class="nd">@iupui</span><span class="o">.</span><span class="n">edu</span>
<span class="n">From</span><span class="p">:</span> <span class="n">cwen</span><span class="nd">@iupui</span><span class="o">.</span><span class="n">edu</span>
<span class="o">...</span>
</pre></div>
</div>
<p>As your file processing programs get more complicated, you may want to
structure your search loops using <code class="docutils literal notranslate"><span class="pre">continue</span></code>. The basic idea
of the search loop is that you are looking for “interesting” lines and
effectively skipping “uninteresting” lines. And then when we find an
interesting line, we do something with that line.</p>
<p>We can structure the loop to follow the pattern of skipping
uninteresting lines as follows:</p>
<p>VerbatimInput{../code3/search3.py}
begin{trinketfiles}
../code3/mbox-short.txt
end{trinketfiles}</p>
<p>The output of the program is the same. In English, the uninteresting
lines are those which do not start with “From:”, which we skip using
<code class="docutils literal notranslate"><span class="pre">continue</span></code>. For the “interesting” lines (i.e., those that
start with “From:”) we perform the processing on those lines.</p>
<p>We can use the <code class="docutils literal notranslate"><span class="pre">find</span></code> string method to simulate a text editor
search that finds lines where the search string is anywhere in the line.
Since <code class="docutils literal notranslate"><span class="pre">find</span></code> looks for an occurrence of a string within
another string and either returns the position of the string or -1 if
the string was not found, we can write the following loop to show lines
which contain the string “&#64;uct.ac.za” (i.e., they come from the
University of Cape Town in South Africa):</p>
<p>VerbatimInput{../code3/search4.py}
begin{trinketfiles}
../code3/mbox-short.txt
end{trinketfiles}</p>
<p>Which produces the following output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">From</span> <span class="n">stephen</span><span class="o">.</span><span class="n">marquard</span><span class="nd">@uct</span><span class="o">.</span><span class="n">ac</span><span class="o">.</span><span class="n">za</span> <span class="n">Sat</span> <span class="n">Jan</span>  <span class="mi">5</span> <span class="mi">09</span><span class="p">:</span><span class="mi">14</span><span class="p">:</span><span class="mi">16</span> <span class="mi">2008</span>
<span class="n">X</span><span class="o">-</span><span class="n">Authentication</span><span class="o">-</span><span class="ne">Warning</span><span class="p">:</span> <span class="nb">set</span> <span class="n">sender</span> <span class="n">to</span> <span class="n">stephen</span><span class="o">.</span><span class="n">marquard</span><span class="nd">@uct</span><span class="o">.</span><span class="n">ac</span><span class="o">.</span><span class="n">za</span> <span class="n">using</span> <span class="o">-</span><span class="n">f</span>
<span class="n">From</span><span class="p">:</span> <span class="n">stephen</span><span class="o">.</span><span class="n">marquard</span><span class="nd">@uct</span><span class="o">.</span><span class="n">ac</span><span class="o">.</span><span class="n">za</span>
<span class="n">Author</span><span class="p">:</span> <span class="n">stephen</span><span class="o">.</span><span class="n">marquard</span><span class="nd">@uct</span><span class="o">.</span><span class="n">ac</span><span class="o">.</span><span class="n">za</span>
<span class="n">From</span> <span class="n">david</span><span class="o">.</span><span class="n">horwitz</span><span class="nd">@uct</span><span class="o">.</span><span class="n">ac</span><span class="o">.</span><span class="n">za</span> <span class="n">Fri</span> <span class="n">Jan</span>  <span class="mi">4</span> <span class="mi">07</span><span class="p">:</span><span class="mi">02</span><span class="p">:</span><span class="mi">32</span> <span class="mi">2008</span>
<span class="n">X</span><span class="o">-</span><span class="n">Authentication</span><span class="o">-</span><span class="ne">Warning</span><span class="p">:</span> <span class="nb">set</span> <span class="n">sender</span> <span class="n">to</span> <span class="n">david</span><span class="o">.</span><span class="n">horwitz</span><span class="nd">@uct</span><span class="o">.</span><span class="n">ac</span><span class="o">.</span><span class="n">za</span> <span class="n">using</span> <span class="o">-</span><span class="n">f</span>
<span class="n">From</span><span class="p">:</span> <span class="n">david</span><span class="o">.</span><span class="n">horwitz</span><span class="nd">@uct</span><span class="o">.</span><span class="n">ac</span><span class="o">.</span><span class="n">za</span>
<span class="n">Author</span><span class="p">:</span> <span class="n">david</span><span class="o">.</span><span class="n">horwitz</span><span class="nd">@uct</span><span class="o">.</span><span class="n">ac</span><span class="o">.</span><span class="n">za</span>
<span class="o">...</span>
</pre></div>
</div>
<p>Here we also use the contracted form of the <code class="docutils literal notranslate"><span class="pre">if</span></code> statement
where we put the <code class="docutils literal notranslate"><span class="pre">continue</span></code> on the same line as the
<code class="docutils literal notranslate"><span class="pre">if</span></code>. This contracted form of the <code class="docutils literal notranslate"><span class="pre">if</span></code> functions
the same as if the <code class="docutils literal notranslate"><span class="pre">continue</span></code> were on the next line and
indented.</p>
</div>
<div class="section" id="letting-the-user-choose-the-file-name">
<h2>Letting the user choose the file name<a class="headerlink" href="#letting-the-user-choose-the-file-name" title="Permalink to this headline">¶</a></h2>
<p>We really do not want to have to edit our Python code every time we want
to process a different file. It would be more usable to ask the user to
enter the file name string each time the program runs so they can use
our program on different files without changing the Python code.</p>
<p>This is quite simple to do by reading the file name from the user using
<code class="docutils literal notranslate"><span class="pre">input</span></code> as follows:</p>
<p>VerbatimInput{../code3/search6.py}
begin{trinketfiles}
../code3/mbox-short.txt
end{trinketfiles}</p>
<p>We read the file name from the user and place it in a variable named
<code class="docutils literal notranslate"><span class="pre">fname</span></code> and open that file. Now we can run the program
repeatedly on different files.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">search6</span><span class="o">.</span><span class="n">py</span>
<span class="n">Enter</span> <span class="n">the</span> <span class="n">file</span> <span class="n">name</span><span class="p">:</span> <span class="n">mbox</span><span class="o">.</span><span class="n">txt</span>
<span class="n">There</span> <span class="n">were</span> <span class="mi">1797</span> <span class="n">subject</span> <span class="n">lines</span> <span class="ow">in</span> <span class="n">mbox</span><span class="o">.</span><span class="n">txt</span>

<span class="n">python</span> <span class="n">search6</span><span class="o">.</span><span class="n">py</span>
<span class="n">Enter</span> <span class="n">the</span> <span class="n">file</span> <span class="n">name</span><span class="p">:</span> <span class="n">mbox</span><span class="o">-</span><span class="n">short</span><span class="o">.</span><span class="n">txt</span>
<span class="n">There</span> <span class="n">were</span> <span class="mi">27</span> <span class="n">subject</span> <span class="n">lines</span> <span class="ow">in</span> <span class="n">mbox</span><span class="o">-</span><span class="n">short</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>Before peeking at the next section, take a look at the above program and
ask yourself, “What could go possibly wrong here?” or “What might our
friendly user do that would cause our nice little program to
ungracefully exit with a traceback, making us look not-so-cool in the
eyes of our users?”</p>
</div>
<div class="section" id="using-try-except-and-open">
<h2>Using <code class="docutils literal notranslate"><span class="pre">try,</span> <span class="pre">except,</span></code> and <code class="docutils literal notranslate"><span class="pre">open</span></code><a class="headerlink" href="#using-try-except-and-open" title="Permalink to this headline">¶</a></h2>
<p>I told you not to peek. This is your last chance.</p>
<p>What if our user types something that is not a file name?</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">search6</span><span class="o">.</span><span class="n">py</span>
<span class="n">Enter</span> <span class="n">the</span> <span class="n">file</span> <span class="n">name</span><span class="p">:</span> <span class="n">missing</span><span class="o">.</span><span class="n">txt</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&quot;search6.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">2</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="n">fhand</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="ne">FileNotFoundError</span><span class="p">:</span> <span class="p">[</span><span class="n">Errno</span> <span class="mi">2</span><span class="p">]</span> <span class="n">No</span> <span class="n">such</span> <span class="n">file</span> <span class="ow">or</span> <span class="n">directory</span><span class="p">:</span> <span class="s1">&#39;missing.txt&#39;</span>

<span class="n">python</span> <span class="n">search6</span><span class="o">.</span><span class="n">py</span>
<span class="n">Enter</span> <span class="n">the</span> <span class="n">file</span> <span class="n">name</span><span class="p">:</span> <span class="n">na</span> <span class="n">na</span> <span class="n">boo</span> <span class="n">boo</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&quot;search6.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">2</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="n">fhand</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="ne">FileNotFoundError</span><span class="p">:</span> <span class="p">[</span><span class="n">Errno</span> <span class="mi">2</span><span class="p">]</span> <span class="n">No</span> <span class="n">such</span> <span class="n">file</span> <span class="ow">or</span> <span class="n">directory</span><span class="p">:</span> <span class="s1">&#39;na na boo boo&#39;</span>
</pre></div>
</div>
<p>Do not laugh. Users will eventually do every possible thing they can do
to break your programs, either on purpose or with malicious intent. As a
matter of fact, an important part of any software development team is a
person or group called <em>Quality Assurance</em> (or QA for
short) whose very job it is to do the craziest things possible in an
attempt to break the software that the programmer has created.</p>
<p>index{Quality Assurance}
index{QA}</p>
<p>The QA team is responsible for finding the flaws in programs before we
have delivered the program to the end users who may be purchasing the
software or paying our salary to write the software. So the QA team is
the programmer’s best friend.</p>
<p>index{try statement}
index{statement!try}
index{open function}
index{function!open}
index{exception!IOError}
index{IOError}</p>
<p>So now that we see the flaw in the program, we can elegantly fix it
using the <code class="docutils literal notranslate"><span class="pre">try</span></code>/<code class="docutils literal notranslate"><span class="pre">except</span></code> structure. We need to
assume that the <code class="docutils literal notranslate"><span class="pre">open</span></code> call might fail and add recovery code
when the <code class="docutils literal notranslate"><span class="pre">open</span></code> fails as follows:</p>
<p>VerbatimInput{../code3/search7.py}
begin{trinketfiles}
../code3/mbox-short.txt
end{trinketfiles}</p>
<p>The <code class="docutils literal notranslate"><span class="pre">exit</span></code> function terminates the program. It is a function
that we call that never returns. Now when our user (or QA team) types in
silliness or bad file names, we “catch” them and recover gracefully:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">search7</span><span class="o">.</span><span class="n">py</span>
<span class="n">Enter</span> <span class="n">the</span> <span class="n">file</span> <span class="n">name</span><span class="p">:</span> <span class="n">mbox</span><span class="o">.</span><span class="n">txt</span>
<span class="n">There</span> <span class="n">were</span> <span class="mi">1797</span> <span class="n">subject</span> <span class="n">lines</span> <span class="ow">in</span> <span class="n">mbox</span><span class="o">.</span><span class="n">txt</span>

<span class="n">python</span> <span class="n">search7</span><span class="o">.</span><span class="n">py</span>
<span class="n">Enter</span> <span class="n">the</span> <span class="n">file</span> <span class="n">name</span><span class="p">:</span> <span class="n">na</span> <span class="n">na</span> <span class="n">boo</span> <span class="n">boo</span>
<span class="n">File</span> <span class="n">cannot</span> <span class="n">be</span> <span class="n">opened</span><span class="p">:</span> <span class="n">na</span> <span class="n">na</span> <span class="n">boo</span> <span class="n">boo</span>
</pre></div>
</div>
<p>index{Pythonic}</p>
<p>Protecting the <code class="docutils literal notranslate"><span class="pre">open</span></code> call is a good example of the proper
use of <code class="docutils literal notranslate"><span class="pre">try</span></code> and <code class="docutils literal notranslate"><span class="pre">except</span></code> in a Python program. We
use the term “Pythonic” when we are doing something the “Python way”. We
might say that the above example is the Pythonic way to open a file.</p>
<p>Once you become more skilled in Python, you can engage in repartee with
other Python programmers to decide which of two equivalent solutions to
a problem is “more Pythonic”. The goal to be “more Pythonic” captures
the notion that programming is part engineering and part art. We are not
always interested in just making something work, we also want our
solution to be elegant and to be appreciated as elegant by our peers.</p>
</div>
<div class="section" id="writing-files">
<h2>Writing files<a class="headerlink" href="#writing-files" title="Permalink to this headline">¶</a></h2>
<p>index{file!writing}</p>
<p>To write a file, you have to open it with mode “w” as a second
parameter:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fout</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;output.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">fout</span><span class="p">)</span>
<span class="go">&lt;_io.TextIOWrapper name=&#39;output.txt&#39; mode=&#39;w&#39; encoding=&#39;cp1252&#39;&gt;</span>
</pre></div>
</div>
<p>If the file already exists, opening it in write mode clears out the old
data and starts fresh, so be careful! If the file doesn’t exist, a new
one is created.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">write</span></code> method of the file handle object puts data into
the file, returning the number of characters written. The default write
mode is text for writing (and reading) strings.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">line1</span> <span class="o">=</span> <span class="s2">&quot;This here&#39;s the wattle,</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line1</span><span class="p">)</span>
<span class="go">24</span>
</pre></div>
</div>
<p>index{newline}</p>
<p>Again, the file object keeps track of where it is, so if you call
<code class="docutils literal notranslate"><span class="pre">write</span></code> again, it adds the new data to the end.</p>
<p>We must make sure to manage the ends of lines as we write to the file by
explicitly inserting the newline character when we want to end a line.
The <code class="docutils literal notranslate"><span class="pre">print</span></code> statement automatically appends a newline, but
the <code class="docutils literal notranslate"><span class="pre">write</span></code> method does not add the newline automatically.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">line2</span> <span class="o">=</span> <span class="s1">&#39;the emblem of our land.</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line2</span><span class="p">)</span>
<span class="go">24</span>
</pre></div>
</div>
<p>When you are done writing, you have to close the file to make sure that
the last bit of data is physically written to the disk so it will not be
lost if the power goes off.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fout</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>We could close the files which we open for read as well, but we can be a
little sloppy if we are only opening a few files since Python makes sure
that all open files are closed when the program ends. When we are
writing files, we want to explicitly close the files so as to leave
nothing to chance.</p>
<p>index{close method}
index{method!close}</p>
</div>
<div class="section" id="debugging">
<h2>Debugging<a class="headerlink" href="#debugging" title="Permalink to this headline">¶</a></h2>
<p>index{debugging}
index{whitespace}</p>
<p>When you are reading and writing files, you might run into problems with
whitespace. These errors can be hard to debug because spaces, tabs, and
newlines are normally invisible:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;1 2</span><span class="se">\t</span><span class="s1"> 3</span><span class="se">\n</span><span class="s1"> 4&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">1 2  3</span>
<span class="go"> 4</span>
</pre></div>
</div>
<p>index{repr function}
index{function!repr}
index{string representation}</p>
<p>The built-in function <code class="docutils literal notranslate"><span class="pre">repr</span></code> can help. It takes any object as
an argument and returns a string representation of the object. For
strings, it represents whitespace characters with backslash sequences:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="go">&#39;1 2\t 3\n 4&#39;</span>
</pre></div>
</div>
<p>This can be helpful for debugging.</p>
<p>One other problem you might run into is that different systems use
different characters to indicate the end of a line. Some systems use a
newline, represented <code class="docutils literal notranslate"><span class="pre">\n</span></code>. Others use a return character, represented
<code class="docutils literal notranslate"><span class="pre">\r</span></code>. Some use both. If you move files between different systems, these
inconsistencies might cause problems.</p>
<p>index{end of line character}</p>
<p>For most systems, there are applications to convert from one format to
another. You can find them (and read more about this issue) at
<a class="reference external" href="wikipedia.org/wiki/Newline">wikipedia.org/wiki/Newline</a>. Or, of course,
you could write one yourself.</p>
</div>
<div class="section" id="glossary">
<h2>Glossary<a class="headerlink" href="#glossary" title="Permalink to this headline">¶</a></h2>
<p>catch
:   To prevent an exception from terminating a program using the</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">C:\Users\shrij\Runestone\py4e-int\_sources\07-files\07-files.rst</span>, line 604)</p>
<p>Unexpected indentation.</p>
</div>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">try</span></code> and <code class="docutils literal notranslate"><span class="pre">except</span></code> statements.</p>
</div></blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">C:\Users\shrij\Runestone\py4e-int\_sources\07-files\07-files.rst</span>, line 605)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</div>
<p>index{catch}</p>
<p>newline
:   A special character used in files and strings to indicate the end of</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">C:\Users\shrij\Runestone\py4e-int\_sources\07-files\07-files.rst</span>, line 609)</p>
<p>Unexpected indentation.</p>
</div>
<blockquote>
<div><p>a line.</p>
</div></blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">C:\Users\shrij\Runestone\py4e-int\_sources\07-files\07-files.rst</span>, line 610)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</div>
<p>index{newline}</p>
<p>Pythonic
:   A technique that works elegantly in Python. “Using try and except is</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">C:\Users\shrij\Runestone\py4e-int\_sources\07-files\07-files.rst</span>, line 614)</p>
<p>Unexpected indentation.</p>
</div>
<blockquote>
<div><p>the <em>Pythonic</em> way to recover from missing files”.</p>
</div></blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">C:\Users\shrij\Runestone\py4e-int\_sources\07-files\07-files.rst</span>, line 615)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</div>
<p>index{Pythonic}</p>
<p>Quality Assurance
:   A person or team focused on insuring the overall quality of a</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">C:\Users\shrij\Runestone\py4e-int\_sources\07-files\07-files.rst</span>, line 619)</p>
<p>Unexpected indentation.</p>
</div>
<blockquote>
<div><p>software product. QA is often involved in testing a product and
identifying problems before the product is released.</p>
</div></blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">C:\Users\shrij\Runestone\py4e-int\_sources\07-files\07-files.rst</span>, line 621)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</div>
<p>index{Quality Assurance}
index{QA}</p>
<p>text file
:   A sequence of characters stored in permanent storage like a hard</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">C:\Users\shrij\Runestone\py4e-int\_sources\07-files\07-files.rst</span>, line 626)</p>
<p>Unexpected indentation.</p>
</div>
<blockquote>
<div><p>drive.</p>
</div></blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">C:\Users\shrij\Runestone\py4e-int\_sources\07-files\07-files.rst</span>, line 627)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</div>
<p>index{text file}</p>
</div>
<div class="section" id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<p><strong>Exercise 1: Write a program to read through a file and print the
contents of the file (line by line) all in upper case. Executing the
program will look as follows:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">shout</span><span class="o">.</span><span class="n">py</span>
<span class="n">Enter</span> <span class="n">a</span> <span class="n">file</span> <span class="n">name</span><span class="p">:</span> <span class="n">mbox</span><span class="o">-</span><span class="n">short</span><span class="o">.</span><span class="n">txt</span>
<span class="n">FROM</span> <span class="n">STEPHEN</span><span class="o">.</span><span class="n">MARQUARD</span><span class="nd">@UCT</span><span class="o">.</span><span class="n">AC</span><span class="o">.</span><span class="n">ZA</span> <span class="n">SAT</span> <span class="n">JAN</span>  <span class="mi">5</span> <span class="mi">09</span><span class="p">:</span><span class="mi">14</span><span class="p">:</span><span class="mi">16</span> <span class="mi">2008</span>
<span class="n">RETURN</span><span class="o">-</span><span class="n">PATH</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">POSTMASTER</span><span class="nd">@COLLAB</span><span class="o">.</span><span class="n">SAKAIPROJECT</span><span class="o">.</span><span class="n">ORG</span><span class="o">&gt;</span>
<span class="n">RECEIVED</span><span class="p">:</span> <span class="n">FROM</span> <span class="n">MURDER</span> <span class="p">(</span><span class="n">MAIL</span><span class="o">.</span><span class="n">UMICH</span><span class="o">.</span><span class="n">EDU</span> <span class="p">[</span><span class="mf">141.211</span><span class="o">.</span><span class="mf">14.90</span><span class="p">])</span>
     <span class="n">BY</span> <span class="n">FRANKENSTEIN</span><span class="o">.</span><span class="n">MAIL</span><span class="o">.</span><span class="n">UMICH</span><span class="o">.</span><span class="n">EDU</span> <span class="p">(</span><span class="n">CYRUS</span> <span class="n">V2</span><span class="o">.</span><span class="mf">3.8</span><span class="p">)</span> <span class="n">WITH</span> <span class="n">LMTPA</span><span class="p">;</span>
     <span class="n">SAT</span><span class="p">,</span> <span class="mi">05</span> <span class="n">JAN</span> <span class="mi">2008</span> <span class="mi">09</span><span class="p">:</span><span class="mi">14</span><span class="p">:</span><span class="mi">16</span> <span class="o">-</span><span class="mi">0500</span>
</pre></div>
</div>
<p><strong>You can download the file from</strong> <a class="reference external" href="http://www.py4e.com/code3/mbox-short.txt">www.py4e.com/code3/mbox-short.txt</a></p>
<p><strong>Exercise 2: Write a program to prompt for a file name, and then read
through the file and look for lines of the form:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">-</span><span class="n">DSPAM</span><span class="o">-</span><span class="n">Confidence</span><span class="p">:</span> <span class="mf">0.8475</span>
</pre></div>
</div>
<p><strong>When you encounter a line that starts with “X-DSPAM-Confidence:” pull
apart the line to extract the floating-point number on the line. Count
these lines and then compute the total of the spam confidence values
from these lines. When you reach the end of the file, print out the
average spam confidence.</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Enter</span> <span class="n">the</span> <span class="n">file</span> <span class="n">name</span><span class="p">:</span> <span class="n">mbox</span><span class="o">.</span><span class="n">txt</span>
<span class="n">Average</span> <span class="n">spam</span> <span class="n">confidence</span><span class="p">:</span> <span class="mf">0.894128046745</span>

<span class="n">Enter</span> <span class="n">the</span> <span class="n">file</span> <span class="n">name</span><span class="p">:</span> <span class="n">mbox</span><span class="o">-</span><span class="n">short</span><span class="o">.</span><span class="n">txt</span>
<span class="n">Average</span> <span class="n">spam</span> <span class="n">confidence</span><span class="p">:</span> <span class="mf">0.750718518519</span>
</pre></div>
</div>
<p><strong>Test your file on the *mbox.txt* and *mbox-short.txt* files.</strong></p>
<p><strong>Exercise 3: Sometimes when programmers get bored or want to have a bit
of fun, they add a harmless *Easter Egg* to their program
Modify the program that prompts the user for the file name so that it
prints a funny message when the user types in the exact file name “na na
boo boo”. The program should behave normally for all other files which
exist and don’t exist. Here is a sample execution of the program:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">egg</span><span class="o">.</span><span class="n">py</span>
<span class="n">Enter</span> <span class="n">the</span> <span class="n">file</span> <span class="n">name</span><span class="p">:</span> <span class="n">mbox</span><span class="o">.</span><span class="n">txt</span>
<span class="n">There</span> <span class="n">were</span> <span class="mi">1797</span> <span class="n">subject</span> <span class="n">lines</span> <span class="ow">in</span> <span class="n">mbox</span><span class="o">.</span><span class="n">txt</span>

<span class="n">python</span> <span class="n">egg</span><span class="o">.</span><span class="n">py</span>
<span class="n">Enter</span> <span class="n">the</span> <span class="n">file</span> <span class="n">name</span><span class="p">:</span> <span class="n">missing</span><span class="o">.</span><span class="n">tyxt</span>
<span class="n">File</span> <span class="n">cannot</span> <span class="n">be</span> <span class="n">opened</span><span class="p">:</span> <span class="n">missing</span><span class="o">.</span><span class="n">tyxt</span>

<span class="n">python</span> <span class="n">egg</span><span class="o">.</span><span class="n">py</span>
<span class="n">Enter</span> <span class="n">the</span> <span class="n">file</span> <span class="n">name</span><span class="p">:</span> <span class="n">na</span> <span class="n">na</span> <span class="n">boo</span> <span class="n">boo</span>
<span class="n">NA</span> <span class="n">NA</span> <span class="n">BOO</span> <span class="n">BOO</span> <span class="n">TO</span> <span class="n">YOU</span> <span class="o">-</span> <span class="n">You</span> <span class="n">have</span> <span class="n">been</span> <span class="n">punk</span><span class="s1">&#39;d!</span>
</pre></div>
</div>
<p><strong>We are not encouraging you to put Easter Eggs in your programs; this is
just an exercise.</strong></p>
</div>
</div>


  <div id=scprogresscontainer>
    You have attempted <span id=scprogresstotal></span> of <span id=scprogressposs></span> activities on this page <div id="subchapterprogress"></div>
  </div>
  
      

<script type="text/javascript">

  $('#relations-prev').tooltip({'placement':'right', 'selector': '', 'delay': { show: 100, hide: 50}});
  $('#relations-next').tooltip({'placement':'left', 'selector': '', 'delay': { show: 100, hide: 50}});

</script>

<script>
	function mouseOverPrev() {
		document.getElementById("relations-prev").style.opacity=1;
	}

	function mouseOutPrev() {
		document.getElementById("relations-prev").style.opacity=0.4;
	}
	function mouseOverNext() {
		document.getElementById("relations-next").style.opacity=1;
	}

	function mouseOutNext() {
		document.getElementById("relations-next").style.opacity=0.4;
	}
</script>
  
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      
      
      <span id='numuserspan'></span><span class='loggedinuser'></span>
      
      
      | <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2020 CS Learning 4 U group.
      Created using <a href="http://runestoneinteractive.org/">Runestone</a> .
    </p>
  </div>
</footer>




<script> getSwitch(); </script>


  </body>
</html>